掲示板アプリケーション README

概要

この掲示板アプリケーションは、ユーザーが名前、メッセージ、および画像（JPEG形式）を投稿できるシンプルなウェブアプリケーションです。投稿された内容は、最新の6件が2列レイアウトで表示されます。

フロントエンドにはReactを使用し、バックエンドはAWSの各種サービス（Lambda、API Gateway、DynamoDB、S3）を活用しています。ユーザーエクスペリエンス、セキュリティ、パフォーマンスを重視し、最新のウェブ開発のベストプラクティスを取り入れています。

当アプリのURL
https://roommoni.s3.ap-northeast-1.amazonaws.com/index.html

機能

	•	投稿機能: ユーザーはお名前、投稿内容、画像（JPEG形式）を入力・選択して投稿できます。
	•	画像プレビュー: 画像を選択すると、投稿前にプレビューが表示されます。
	•	バリデーション: お名前と投稿内容は必須項目として、未入力の場合はエラーメッセージが表示されます。お名前の入力は最大50文字、投稿内容は最大500文字に制限されています。
	•	投稿一覧表示: 投稿された内容が2列のグリッドレイアウトで表示されます。最新の投稿が上部に表示され、最大6件まで表示します
	•	レスポンシブデザイン: CSS Gridを使用し、デバイスの画面サイズに応じてレイアウトが調整されます。スマートフォンでは1列表示に自動で切り替わります。
	•	リアルタイム通知機能: ユーザーが画像を投稿すると、その画像がS3バケットに保存され、AWS LambdaをトリガーとしてLINE Notifyを介してリアルタイムに通知が送信されます。

技術スタック

	•	フロントエンド:
	•	React（バージョン18、CDN経由）
	•	JavaScript（ES6+）
	•	HTML5
	•	CSS3（外部スタイルシート）
	•	バックエンド:
	•	AWS Lambda（Python）
	•	AWS API Gateway
	•	AWS DynamoDB（データ保存）
	•	AWS S3（画像保存と静的ウェブホスティング）
	•	LINE Notify（外部API連携）

特徴と工夫

ユーザーエクスペリエンスの向上

	•	リアルタイムな投稿一覧の更新: 新しい投稿が行われると、自動的に投稿一覧が更新されます。
	•	バリデーションの実装: 必須項目のチェックにより、ユーザーが必要な情報を確実に入力できるようにしています。
	•	アクセシビリティの配慮: labelタグの適切な使用や、画像のalt属性の設定により、アクセシビリティを向上させています。

セキュリティへの配慮

	•	XSS対策: ユーザーからの入力をエスケープし、クロスサイトスクリプティング攻撃を防止しています。
	•	CORS設定の適切な管理: バックエンドとの通信において、CORSの設定を適切に行い、セキュリティと機能性を両立させています。
	•	機密情報の安全な管理: 環境変数を使用して、アクセストークンやバケット名などの機密情報を安全に管理しています。

コードの品質と保守性

	•	最新のReact機能の活用: useState、useEffect、useCallbackなどのフックを適切に使用し、コードの可読性と効率性を高めています。
	•	外部スタイルシートの使用: CSSを外部ファイルに分離し、HTMLの構造とスタイルを明確に分けています。
	•	パフォーマンスの最適化: 不要な再レンダリングを防ぐために、useCallbackを使用して関数をメモ化しています。

AWSサービスの活用

	•	サーバーレスアーキテクチャ: AWS Lambdaを使用し、サーバーの管理コストを削減しています。
	•	イベント駆動アーキテクチャ: S3のオブジェクト作成イベントをトリガーにLambda関数を実行し、LINE Notifyへの通知を行っています。
	•	データの永続化: DynamoDBを使用して、スケーラブルで高可用性のデータストレージを実現しています。
	•	画像の保存と配信: S3バケットに画像を保存し、効率的なコンテンツ配信を行っています。

追加機能：S3ファイル保存時の自動通知

	•	リアルタイム通知機能: ユーザーが画像を投稿すると、その画像がS3バケットに保存されます。その際に、Lambda関数がトリガーされ、LINE Notifyを介してリアルタイムに通知が送信されます。
	•	技術的なポイント:
	•	イベントドリブンアーキテクチャ: S3のオブジェクト作成イベントをトリガーにLambda関数を実行します。
	•	外部API連携: Lambda関数からLINE NotifyのAPIを呼び出し、メッセージと画像を送信します。
	•	セキュリティの強化: LINE Notifyのアクセストークンを環境変数として管理し、コード内に直接記述しないようにしています。

セットアップとデプロイ

1. AWSサービスの設定

DynamoDBテーブル

	•	連番管理テーブル: sequenceテーブルを作成し、tablename（パーティションキー）とseq（数値）を持つように設定します。
	•	メッセージデータテーブル: message_boardテーブルを作成し、id（パーティションキー）とその他の必要な項目（name、msg、postat、has_imageなど）を設定します。

S3バケット

	•	画像保存用バケット: 画像を保存するためのS3バケットを作成します。パブリックアクセスの設定を適切に行い、画像が表示できるようにします。
	•	静的ウェブホスティング用バケット: index.htmlとstyles.cssを配置するためのS3バケットを作成します。静的ウェブホスティングを有効化し、パブリックアクセスの設定を行います。

Lambda関数

	•	投稿用Lambda関数:
	•	コードを使用してLambda関数を作成し、以下の環境変数を設定します：
	•	S3_BUCKET_NAME: 画像保存用のS3バケット名
	•	SEQUENCE_TABLE: sequenceテーブル名
	•	MESSAGE_TABLE: message_boardテーブル名
	•	投稿取得用Lambda関数:
	•	環境変数を設定します：
	•	S3_BUCKET_NAME: 画像保存用のS3バケット名
	•	MESSAGE_TABLE: message_boardテーブル名
	•	通知用Lambda関数:
	•	環境変数を設定します：
	•	LINE_ACCESS_TOKEN: LINE Notifyのアクセストークン

2. フロントエンドの配置

	•	ファイルのアップロード:
	•	index.htmlとstyles.cssを静的ウェブホスティング用のS3バケットにアップロードします。
	•	バケットポリシーの設定:
	•	パブリックアクセスが可能になるように、バケットポリシーとパブリックアクセス設定を適切に設定します。

3. 動作確認

	•	ブラウザでの確認:
	•	S3バケットのエンドポイントにアクセスし、アプリケーションが正常に動作することを確認します。
	•	機能のテスト:
	•	投稿機能、画像アップロード、バリデーション、投稿一覧の表示などが期待通りに動作するかテストします。
	•	画像を投稿した際に、LINE Notifyで通知が受信されることを確認します。

課題と今後の展望

	•	認証と認可: 現状では認証機能が実装されていないため、今後はユーザー管理やログイン機能の追加を検討しています。
	•	テストの充実: 単体テストや統合テストを導入し、品質を保証する体制を整えたいと考えています。
	•	エラーハンドリングの強化: ユーザーに対するエラーメッセージの充実や、ログの適切な管理を進めていきます。
	•	パフォーマンスの監視: CloudWatchなどを活用し、アプリケーションのパフォーマンスを継続的に監視します。

ファイル構成

	•	README.md（本ドキュメント）
	•	index.html（フロントエンドのHTMLファイル）
	•	styles.css（スタイルシート）
	•	lambda_functions/post_message.py（投稿用Lambda関数）
	•	lambda_functions/get_messages.py（投稿取得用Lambda関数）
	•	lambda_functions/notify_line.py（通知用Lambda関数）
